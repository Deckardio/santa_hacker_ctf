# Web

![[Pasted image 20211226234833.png]]

Случай взят при создании NULLED версии одного из популярных продуктов на PHP

Здесь рассматривается случай без запуска приложения на ПК. С запуском всё быстрее и проще в разы. (Достаточно просто ключ лицензии поменять и можно уже увидеть за что цепляться или дебаггером подключиться)

Большинство приложений используют переменные среды, чтобы задавать настройки.

Начинать стоило с просмотра файлов проекта, исключая папку vendor на первом этапе. Данная папка является просто тащащей в себе зависимости. У каждого языка программирования есть такая.

Например, важным файлом является .env или если удача у вас в руках - то /src/Kernel.php

Там есть обращение к LICENSE_KEY

Можно было попробовать сделать поиск по коду и найти все места, где находится LICENSE_KEY

Видим такую штуку

![[Pasted image 20211226234844.png]]

Поиск по коду не даёт ничего. Не существует никакого checkLicense, а он есть.

![[Pasted image 20211226234852.png]]

Перемещаясь на уровень выше, мы видим, что приложение подтягивает файл из /vendor/autoload_runtime.php

Переходим в него и видим, что он с самого начала тянет еще файл: autoload.php

![[Pasted image 20211226234901.png]]

Перейдя в autoload.php, видим, что он тянет еще один файл autoload_real.php

![[Pasted image 20211226234908.png]]

Открывая данный файл, мы видим, что здесь всё находится в одну строку, что наводит на подозрения.

Прогоняем код через beautifier и начинаем его читать

![[Pasted image 20211226234918.png]]

Видим что-то закодированное

![[Pasted image 20211226234927.png]]

Раскодируем и увидим, что он зачем-то содержит путь до файла lang.lock

![[Pasted image 20211226234935.png]]

Не вдаваясь в глубокие подробности, PHP позволяет регистрировать класс через stream_register_wrapper

Открывая файл lang.lock - видим, что там содержится base64, который не декодируется.

Смотрим обратно в код - видим

![[Pasted image 20211226234943.png]]

Вставим в данную цепочку функций код с файла и получим флаг

![[Pasted image 20211226234951.png]]

P.S Другой способ был - посмотреть время и дату модификации файлов в архиве