# Crypto
![[task_santa.png]]

В содержимом файла мы выдим следующее:

`c: 1711201983791207338820629855775430240386839367984450346263791293199827495747063083730680198376442568926777261273209490137399892421435665135922746130556122309667823299800464859975532364713408290451086559750153091271889493983779378284805771533407214341544668672115936113250415492656765862191741269767750382168691617352969019765554935257626185398169175848719014813895375061952620523672875559026881801145012951761962649413397122566796164456642912439816499416512724828699726293665636180896331725462439884577604483711404013330749861819059309013624976958733544929724827301295930272526053604980297842108910949461618619234515333698718406831161225224966630302536333036120812747135107853566366637912000868477991003372474028284752566225022945674552222626672091269042566219566282407492969364284163957799547089070153223766154280359964926294563699961953841326811817097485179076085709043544029421557618032194036543215078533256742405150653437
n: 4247245608945068947379114678430247108569828078460045707025740985323832355227169381838923404691234526142102358553457928186330642490676610827938918022731519884588653052742391996949022428421020125599610544376261531609722650823695304694604774412936658622365008155098853623717380846680087689422408635908170060514217723702707045297545107044991937756959456365662609026846091757973468881525926284654952153191761061578125070020449096179160033837495293933806390949309638630725491184160531024388919599937636215569679684365561802993357629020487575530124304647388454446943597625660335564499621789496754053973014398617688138616587884872913977802583570750203428400000979105462199798409324074337983438439384360521139530400401307867572285975829025463767409333225963828647658870387271115832968824172390350952001776506765179828706786857215321464040087845998927819630266036759437045718121032524998774229724222512467640848802429243823614635508619
e: 65537`

Судя по значением n и e мы имеем дело с шифрованием RSA, где `n` это `p*q` - простые числа, `e`  - открытая экспонента. Существует множество решений задач связанных с RSA и в первую очередь необходимо определить, какой тип уязвимости тут присутствует.


В первую очередь стоит обратиться к открытым базам данных факторизации `p*q`, наиболее популярной является [Factordb](http://factordb.com/), и там мы находим что данная `n` является произведением `p=181055757517183570913782889173004313048917021264806075746010198536701308664562909182988355863939550680127778737345366793  
634057525881571488947524563792805485229457801113377840137244034253240219830522255477405302942789619777954204181832282506  
365032053444021169260682415151435594216224592875350179609979016915675537869929242402173895489197489931474270024716730493  
0209041301952818994224558220603514714097684651588266575747789963648042083552143663207063481113941626083` и `q=234582189883797148946298685856686207329821294405311785751067753559363451352786632120766180430447646130599631051112317897  
493985866512527549498566298112762517344312705536162413621549670126128061424689766346527447822188762846396079233373826461  
410235818459099605146932689122701361772087757775407038593153441766694523517453554430067861061515159473956808794495594388  
8908739423219576117370251860277822221274907339756794103121843473684483578860427727798729711325430126393`

![[factordb.png]]

Теперь для расшифровки нашего сообщения у нас есть все необходимые значения.
Poc будет выглядить следующим образом:


```python
from Crypto.Util.number import *
from math import gcd
n = 4247245608945068947379114678430247108569828078460045707025740985323832355227169381838923404691234526142102358553457928186330642490676610827938918022731519884588653052742391996949022428421020125599610544376261531609722650823695304694604774412936658622365008155098853623717380846680087689422408635908170060514217723702707045297545107044991937756959456365662609026846091757973468881525926284654952153191761061578125070020449096179160033837495293933806390949309638630725491184160531024388919599937636215569679684365561802993357629020487575530124304647388454446943597625660335564499621789496754053973014398617688138616587884872913977802583570750203428400000979105462199798409324074337983438439384360521139530400401307867572285975829025463767409333225963828647658870387271115832968824172390350952001776506765179828706786857215321464040087845998927819630266036759437045718121032524998774229724222512467640848802429243823614635508619
e = 65537
c = 1771200280336538879854967313775195934159855250934662075762726925314209714160569233066867610804574006158846073119466403823788184698255209244941278923570831245876806297714039315757706528201329482088820886154339828844288722437020037076142160975525326914117822259783044004632688395043595622334959078897217111117257760309053241808638593249758716663546466267069136331619032996109038689122209728943292644583766705289164130439396954014773046874180300018338748616790404136922613090308890216960169892701955050265161408039845863673513656338282755021952025707099800506549921744544637672170473629571293118988085739661958001615585955821222725415413407719943324136224789279764506739107372081873510199888507301533147329039024094434264257820407731210589479659547688173690278263046782525022874413087488681336670848727705870285172070994221389377833032082784286270055672534846548659628856163851144840557792874134890339243682145258899304524062880
p = 2345821898837971489462986858566862073298212944053117857510677535593634513527866321207661804304476461305996310511123178974939858665125275494985662981127625173443127055361624136215496701261280614246897663465274478221887628463960792333738264614102358184590996051469326891227013617720877577754070385931534417666945235174535544300678610615151594739568087944955943888908739423219576117370251860277822221274907339756794103121843473684483578860427727798729711325430126393
q = 1810557575171835709137828891730043130489170212648060757460101985367013086645629091829883558639395506801277787373453667936340575258815714889475245637928054852294578011133778401372440342532402198305222554774053029427896197779542041818322825063650320534440211692606824151514355942162245928753501796099790169156755378699292424021738954891974899314742700247167304930209041301952818994224558220603514714097684651588266575747789963648042083552143663207063481113941626083

def lcm(x, y):
    return (x * y) // gcd(x, y)


def ex_euclid(x, y):
    c0, c1 = x, y
    a0, a1 = 1, 0
    b0, b1 = 0, 1

    while c1 != 0:
        m = c0 % c1
        q = c0 // c1

        c0, c1 = c1, m
        a0, a1 = a1, (a0 - q * a1)
        b0, b1 = b1, (b0 - q * b1)

    return a0, b0


t = lcm(p - 1, q - 1)
a, b = ex_euclid(e, t)
d = a % t

m = pow(c, d, n)

print(long_to_bytes(m))
```

В итоге мы получаем наш флаг **IMKT{5anta_give_me_good_primes_4_r5a}**:

	`b'\x02\xd4eXL"...\x13\xa7\x00IMKT{5anta_give_me_good_primes_4_r5a}'